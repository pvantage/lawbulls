<!doctype html>
<html lang="en">
   <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">      
      <link rel="stylesheet" href="css/bootstrap.min.css">
      <link rel="stylesheet" href="css/style.css?v=1">
      <link rel="stylesheet" href="css/font-awesome.min.css">
      <link rel="stylesheet" type="text/css" href="css/menu_sideslide.css" />
      <link rel="stylesheet" type="text/css" href="css/normalize.css" />
      <title>Law Bulls</title>
      <script src="js/jquery.js"></script>
		<script type="text/javascript" charset="utf-8" src="cordova.js"></script>
        <script src="js/popper.js"></script>
        <script src="js/bootstrap.min.js"></script>
        <script type="text/javascript" src="js/function.js"></script>
        <script type="text/javascript">
            checkLogin();
        </script>
   </head>
   <body>
   
   <div class="top-header">
         <div class="container">
            <div class="menu-items">
               <div class="mobile-menu">
                  <img src="images/hamburger-icon.png" alt="" id="open-button" />
               </div>
               <div class="menu-wrap">
                  <div class="profile-info">
                     <img src="images/blank-profile.jpeg" alt="" id="profile_img"/>
                     <span class="username"></span>
                      <span class="profile-edit-arrow"><a href="edit-profie.html"><i class="fa fa-pencil" aria-hidden="true"></i></a></span>
                  </div>
                  <nav class="menu">
                     <div class="icon-list">   
                        <a href="home.html"><img src="images/home.png" alt="" /><span>Home</span></a>
                        <a href="casefinder.html"><img src="images/hammer_icon.png" alt="" /><span>Case finder <span class="casepro">Pro</span></span></a>
                        <a href="favourite.html"><img src="images/favourite_icon.png" alt="" /><span>Favorites</span></a>
                        <a href="myorder.html"><img src="images/order_icon.png" alt="" /><span>My Orders</span></a>
                        <a href="previous-order.html"><img src="images/order_icon2.png" alt="" /><span>Previous Orders</span></a>
                        <a href="feedback.html"><img src="images/feedback.png" alt="" /><span>Feedback</span></a>
                        <a href="#"><img src="images/terms_icon.png" alt="" /><span>Terms & conditions</span></a>
                        <a href="#"><img src="images/about_icon.png" alt="" /><span>About Us</span></a>
                     </div>
                  </nav>
                  <div class="menu-footer">
                     <div class="float-left">
                        <a href="javascript:void(0);" onclick="logOut();">Sign Out</a>
                     </div>
                     <div class="float-right">
                        <ul class="menu-social">
                           <li><a href="https://www.facebook.com/LawBullsIndia" target="_blank"><i class="fa fa-facebook" aria-hidden="true"></i></a></li>
                           <li><a href="https://www.instagram.com/lawbulls" target="_blank"><i class="fa fa-instagram" aria-hidden="true"></i></a></li>
                           <li><a href="#" target="_blank"><i class="fa fa-snapchat-ghost" aria-hidden="true"></i></a></li>
                        </ul>
                     </div>
                  </div>
                  <button class="close-button" id="close-button">Close Menu</button>
               </div>
               <div class="logo-div">
                  <a href="home.html"><img src="images/applogo.png" alt="Law Bulls"></a>
               </div>
               <div class="search-div">
                    <a href="search.html"> <img src="images/searchicon.png" alt="Search" /></a>
               </div>
            </div>
         </div>
      </div>
   
   
   
   
    <div class="top-profile">
    <div class="container">
    
    <div class="Profile-picture">
     <img src="images/blank-profile.jpg" alt="" id="upload_profile_img" />
     <div class="edit-icon">
      <a href="javascript:void(0);" onclick="getImage();"><i class="fa fa-pencil" aria-hidden="true"></i></a>
     </div>
     </div>
    </div>
    
    </div>
      <div class="container">
         <div class="case-finder">
            <div id="edit_profile">
            <input type="hidden" name="user_id" id="user_id" />
               <div class="form-group">
                  <label> First Name <em>*</em></label>
                  <input type="text" name="first_name" id="first_name" />
               </div>
               <div class="form-group">
                  <label>Last Name</label>
                  <input type="text" name="last_name" id="last_name"> 
               </div>
               <div class="form-group">
                  <label>Mobile Number <em>*</em></label>
                 <input type="number" name="mobile_number" id="mobile_number" maxlength="10"> 
               </div>              
               <div class="buuton_divv">
                  <a href="change-password.html">Change Password</a>
                  <button class="button" onClick="updateProfile()">Update Details</button>
               </div>
            </div>
         </div>
    </div>
 <div class="botom-imgwithlongcontent">
    <img src="images/bottombackgroundimg.png" alt="">
</div>

<div class="modal fade" id="msgModal" role="dialog">
<div class="modal-dialog">
    <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>         
        </div>
        <div class="modal-body"><div class="modal_content"></div></div>        
    </div>
</div>
</div>
<div class="loading" id="loader"><div class="loadercase"><img src="images/loader_img.gif" alt="Please wait" /></div></div> 
<script src="js/classie.js"></script>
<script src="js/main.js"></script>
<script src="js/aos.js"></script>
<script type="text/javascript">
getLoginname();
getProfileimg();
AOS.init();
create_nav();  
function getImage(){
           navigator.camera.getPicture(uploadPhoto, function(message){
			//alert('Error!!');			
		},{
			quality:60,
			correctOrientation: true,
			allowEdit : true,
			targetWidth: 500,
            targetHeight: 500,						
			destinationType: navigator.camera.DestinationType.FILE_URI,
			sourceType: navigator.camera.PictureSourceType.PHOTOLIBRARY
		});
 
  }
 
function uploadPhoto(imageURI) {
			var upload_url = siteurl + 'account.php?pageacct=profImg&prof_id=' + localStorage.getItem("login_id");			
            var options1 = new FileUploadOptions();
            options1.fileKey="file";
            options1.fileName=imageURI.substr(imageURI.lastIndexOf('/')+1);
            options1.mimeType="image/jpeg";
 
            var params1 = new Object();
            params1.value1 = "test";
            params1.value2 = "param";
 
            options1.params1 = params1;
            options1.chunkedMode = false;
 
            var ft1 = new FileTransfer();
            ft1.upload(imageURI, upload_url, win, fail, options1);
        }
 
        function win(r){            
			var resturn_data_1 = jQuery.parseJSON(r.response);
			
			if(resturn_data_1.success)
			{
				$('#upload_profile_img').attr('src', resturn_data_1.success);				
			}else if(resturn_data_1.error)
			{				
				$('.modal_content').html(resturn_data_1.error);
				$('#msgModal').modal('show');
			}
            
        }
 
        function fail(error) {           
		   $('.modal_content').html('Failed to upload');
		   $('#msgModal').modal('show');
			
}
</script>
<script type="text/javascript">
$(document).ready(function(e) {
   $('#user_id').val(localStorage.getItem("login_id"));
   getUserinfo();
});

function getUserinfo(){
	var action_url = siteurl + 'account.php?pageacct=getProfile';	
	$.ajax({
	 type: 'POST',
	 url: action_url,
	 dataType: 'json',
	 data: {user_id:localStorage.getItem("login_id")},
	 crossDomain: true,
	 success: function(data){
	   	if(data['success']){
			$('#first_name').val(data['success']['first_name']);
			$('#last_name').val(data['success']['last_name']);
			$('#mobile_number').val(data['success']['mobile']);
			$('#upload_profile_img').attr('src', data['success']['img']);
			$('#loader').remove();	
		}
	 }
   });
}

function updateProfile(){
	var action_url = siteurl + 'account.php?pageacct=update_profile';	
	$.ajax({
	 type: 'POST',
	 url: action_url,
	 dataType: 'json',
	 data: $('#edit_profile input[type=\'text\'], #edit_profile input[type=\'number\'], #edit_profile input[type=\'hidden\']'),
	 crossDomain: true,
	 success: function(data){		 
		$('.error').remove();
		 		 		 
	   	if(data['success'])
		{	
			localStorage.setItem('disp_name', data['success']['disp_name']);
			
			$('.modal_content').html('Profile updated successfully.');
			$('#msgModal').modal('show');		
			//window.location = "home.html";
			
		}else if(data['error']){
			
			if(data['error']['first_name']){
				$('#first_name').after('<span class="error text-danger">' + data['error']['first_name'] + '</span>');
			}
			
			if(data['error']['last_name']){
				$('#last_name').after('<span class="error text-danger">' + data['error']['last_name'] + '</span>');
			}
			
			if(data['error']['mobile_number']){
				$('#mobile_number').after('<span class="error text-danger">' + data['error']['mobile_number'] + '</span>');
			}			
		}
	 }
   });
}

</script>
   </body>
</html>